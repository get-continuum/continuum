{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://getcontinuum.dev/schemas/decision.v0.schema.json",
  "title": "Continuum Decision",
  "description": "Schema for a Continuum Decision object â€” the atomic unit of institutional knowledge.",
  "schema_version": "0.1.0",
  "type": "object",
  "required": [
    "id",
    "version",
    "status",
    "title",
    "created_at",
    "updated_at"
  ],
  "properties": {
    "id": {
      "type": "string",
      "pattern": "^dec_[a-zA-Z0-9]+$",
      "description": "Unique decision identifier."
    },
    "version": {
      "type": "integer",
      "minimum": 0,
      "description": "Version number, starting at 0."
    },
    "status": {
      "type": "string",
      "enum": ["draft", "active", "superseded", "archived"],
      "description": "Current lifecycle status of the decision."
    },
    "title": {
      "type": "string",
      "minLength": 1,
      "description": "Human-readable title describing the decision."
    },
    "created_at": {
      "type": "string",
      "format": "date-time",
      "description": "ISO 8601 timestamp of when the decision was created."
    },
    "updated_at": {
      "type": "string",
      "format": "date-time",
      "description": "ISO 8601 timestamp of when the decision was last updated."
    },
    "rationale": {
      "type": "string",
      "description": "Explanation of why this decision was made."
    },
    "stakeholders": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "description": "List of people or teams involved in the decision."
    },
    "metadata": {
      "type": "object",
      "description": "Arbitrary key-value metadata."
    },
    "options_considered": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["id", "title", "selected"],
        "properties": {
          "id": {
            "type": "string",
            "pattern": "^opt_[a-zA-Z0-9]+$",
            "description": "Unique option identifier."
          },
          "title": {
            "type": "string",
            "description": "Description of the option."
          },
          "selected": {
            "type": "boolean",
            "description": "Whether this option was chosen."
          },
          "rejected_reason": {
            "type": "string",
            "description": "Reason this option was rejected, if applicable."
          }
        },
        "additionalProperties": false
      },
      "description": "List of options that were considered for this decision."
    },
    "context": {
      "$ref": "https://getcontinuum.dev/schemas/context.v0.schema.json",
      "description": "Information about what triggered the decision."
    },
    "scope": {
      "type": "string",
      "description": "Where this decision applies (e.g., repo:acme/backend, folder:src/api)."
    },
    "key": {
      "type": "string",
      "description": "User-provided semantic binding key within the scope."
    },
    "binding_key": {
      "type": "string",
      "description": "Non-null binding key: key if provided, else title. Uniqueness enforced on (scope, binding_key)."
    },
    "value_hash": {
      "type": "string",
      "description": "Fingerprint of the decision value for idempotency checks."
    },
    "decision_type": {
      "type": "string",
      "enum": ["interpretation", "rejection", "preference", "behavior_rule"],
      "description": "Category of the decision."
    },
    "supersedes": {
      "type": "string",
      "pattern": "^dec_[a-zA-Z0-9]+$",
      "description": "ID of the decision this one replaces."
    },
    "precedence": {
      "type": "integer",
      "description": "Priority level for conflict resolution. Higher values take precedence."
    },
    "override_policy": {
      "type": "string",
      "enum": ["invalid_by_default", "warn", "allow"],
      "default": "invalid_by_default",
      "description": "What happens when a rejected option is encountered."
    }
  },
  "additionalProperties": false
}
